<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –ø–∞–º—è—Ç–∏ AI üß†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            height: 100vh;
            overflow: hidden;
        }
        
        .game-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }
        
        .game-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #4ECDC4;
        }
        
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            flex: 1;
            margin-bottom: 20px;
        }
        
        .memory-card {
            aspect-ratio: 1;
            background: rgba(255,255,255,0.15);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 2px solid transparent;
        }
        
        .memory-card.flipped {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            transform: rotateY(180deg);
        }
        
        .memory-card.matched {
            background: linear-gradient(45deg, #4ECDC4, #45B7D1);
            border-color: #4ECDC4;
        }
        
        .controls {
            display: flex;
            gap: 10px;
        }
        
        .control-btn {
            flex: 1;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 15px;
            color: white;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .control-btn:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .ai-learning-panel {
            background: rgba(0,0,0,0.5);
            padding: 15px;
            border-radius: 15px;
            margin-top: 15px;
            font-size: 0.9em;
        }
        
        @media (max-width: 480px) {
            .memory-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1>üß† –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –ø–∞–º—è—Ç–∏ AI</h1>
            <p>–ü–æ–º–æ–≥–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ —É–ª—É—á—à–∏—Ç—å –ø–∞–º—è—Ç—å –∏ –≤–Ω–∏–º–∞–Ω–∏–µ</p>
        </div>
        
        <div class="stats">
            <div class="stat-item">
                <div class="stat-value" id="score">0</div>
                <div>–û—á–∫–∏</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="level">1</div>
                <div>–£—Ä–æ–≤–µ–Ω—å</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="matches">0</div>
                <div>–ù–∞–π–¥–µ–Ω–æ –ø–∞—Ä</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="time">60</div>
                <div>–í—Ä–µ–º—è</div>
            </div>
        </div>
        
        <div class="memory-grid" id="memoryGrid">
            <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
        </div>
        
        <div class="controls">
            <button class="control-btn" onclick="startGame()">üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            <button class="control-btn" onclick="increaseDifficulty()">‚ö° –°–ª–æ–∂–Ω–µ–µ</button>
            <button class="control-btn" onclick="analyzeAIPerformance()">üìä –ê–Ω–∞–ª–∏–∑ AI</button>
            <button class="control-btn" onclick="window.closeGame()">‚Üê –ù–∞–∑–∞–¥</button>
        </div>
        
        <div class="ai-learning-panel" id="aiLearningPanel">
            <strong>ü§ñ –û–±—É—á–µ–Ω–∏–µ AI:</strong> 
            <span id="learningStatus">–°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞—Ö –ø–∞–º—è—Ç–∏...</span>
        </div>
    </div>

    <script>
        class MemoryGame {
            constructor() {
                this.cards = [];
                this.flippedCards = [];
                this.matchedPairs = 0;
                this.score = 0;
                this.level = 1;
                this.timeLeft = 60;
                this.timer = null;
                this.isPlaying = false;
                this.aiTrainingData = [];
                
                this.symbols = ['üçé', 'üçå', 'üçí', 'üçï', 'üèÄ', '‚öΩ', 'üéÆ', 'üé∏', 'üöó', '‚úàÔ∏è', '‚≠ê', '‚ù§Ô∏è'];
                this.init();
            }
            
            init() {
                this.generateCards();
                this.renderGrid();
                this.setupEventListeners();
                this.startAILearning();
            }
            
            generateCards() {
                const pairsNeeded = 6 + (this.level - 1) * 2;
                const selectedSymbols = this.symbols.slice(0, pairsNeeded);
                
                this.cards = [];
                selectedSymbols.forEach(symbol => {
                    this.cards.push({ id: this.cards.length, symbol, flipped: false, matched: false });
                    this.cards.push({ id: this.cards.length, symbol, flipped: false, matched: false });
                });
                
                // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
                this.cards = this.cards.sort(() => Math.random() - 0.5);
            }
            
            renderGrid() {
                const grid = document.getElementById('memoryGrid');
                grid.innerHTML = '';
                
                this.cards.forEach(card => {
                    const cardElement = document.createElement('div');
                    cardElement.className = 'memory-card';
                    cardElement.dataset.id = card.id;
                    cardElement.innerHTML = card.flipped || card.matched ? card.symbol : '?';
                    
                    if (card.flipped) cardElement.classList.add('flipped');
                    if (card.matched) cardElement.classList.add('matched');
                    
                    grid.appendChild(cardElement);
                });
            }
            
            setupEventListeners() {
                document.getElementById('memoryGrid').addEventListener('click', (e) => {
                    if (!this.isPlaying) return;
                    
                    const cardElement = e.target.closest('.memory-card');
                    if (!cardElement) return;
                    
                    const cardId = parseInt(cardElement.dataset.id);
                    this.flipCard(cardId);
                });
            }
            
            flipCard(cardId) {
                if (this.flippedCards.length >= 2) return;
                
                const card = this.cards.find(c => c.id === cardId);
                if (!card || card.flipped || card.matched) return;
                
                card.flipped = true;
                this.flippedCards.push(card);
                this.renderGrid();
                
                // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è AI
                this.recordAITrainingData('human_move', {
                    cardId,
                    symbol: card.symbol,
                    flippedCards: this.flippedCards.length,
                    timestamp: Date.now()
                });
                
                if (this.flippedCards.length === 2) {
                    setTimeout(() => this.checkMatch(), 1000);
                }
            }
            
            checkMatch() {
                const [card1, card2] = this.flippedCards;
                
                if (card1.symbol === card2.symbol) {
                    // –ù–∞–π–¥–µ–Ω–∞ –ø–∞—Ä–∞
                    card1.matched = true;
                    card2.matched = true;
                    this.matchedPairs++;
                    this.score += 10 * this.level;
                    
                    this.recordAITrainingData('successful_match', {
                        symbols: [card1.symbol, card2.symbol],
                        timeToMatch: Date.now() - this.flipStartTime,
                        level: this.level
                    });
                    
                    this.updateStats();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è
                    if (this.matchedPairs === this.cards.length / 2) {
                        this.levelComplete();
                    }
                } else {
                    // –ù–µ —Å–æ–≤–ø–∞–ª–æ
                    card1.flipped = false;
                    card2.flipped = false;
                    
                    this.recordAITrainingData('failed_match', {
                        symbols: [card1.symbol, card2.symbol],
                        attempts: this.flippedCards.length
                    });
                }
                
                this.flippedCards = [];
                this.renderGrid();
            }
            
            levelComplete() {
                this.score += this.timeLeft * 5;
                this.level++;
                this.updateStats();
                
                this.recordAITrainingData('level_complete', {
                    level: this.level - 1,
                    score: this.score,
                    timeRemaining: this.timeLeft
                });
                
                setTimeout(() => {
                    alert(`üéâ –£—Ä–æ–≤–µ–Ω—å ${this.level - 1} –ø—Ä–æ–π–¥–µ–Ω! –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —É—Ä–æ–≤–µ–Ω—å ${this.level}`);
                    this.generateCards();
                    this.renderGrid();
                }, 500);
            }
            
            startGame() {
                this.isPlaying = true;
                this.score = 0;
                this.level = 1;
                this.matchedPairs = 0;
                this.timeLeft = 60;
                this.generateCards();
                this.renderGrid();
                this.updateStats();
                this.startTimer();
            }
            
            startTimer() {
                if (this.timer) clearInterval(this.timer);
                
                this.timer = setInterval(() => {
                    this.timeLeft--;
                    document.getElementById('time').textContent = this.timeLeft;
                    
                    if (this.timeLeft <= 0) {
                        this.gameOver();
                    }
                }, 1000);
            }
            
            gameOver() {
                this.isPlaying = false;
                clearInterval(this.timer);
                
                this.recordAITrainingData('game_over', {
                    finalScore: this.score,
                    finalLevel: this.level,
                    totalMatches: this.matchedPairs
                });
                
                alert(`üíÄ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á—ë—Ç: ${this.score}`);
                this.saveAITrainingData();
            }
            
            updateStats() {
                document.getElementById('score').textContent = this.score;
                document.getElementById('level').textContent = this.level;
                document.getElementById('matches').textContent = this.matchedPairs;
            }
            
            increaseDifficulty() {
                this.timeLeft = Math.max(30, this.timeLeft - 10);
                document.getElementById('time').textContent = this.timeLeft;
                
                this.recordAITrainingData('difficulty_increased', {
                    newTimeLimit: this.timeLeft,
                    currentLevel: this.level
                });
            }
            
            // AI Learning Methods
            startAILearning() {
                setInterval(() => {
                    this.generateAIPattern();
                }, 30000); // –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            }
            
            recordAITrainingData(event, data) {
                this.aiTrainingData.push({
                    event,
                    data,
                    timestamp: Date.now(),
                    gameState: {
                        level: this.level,
                        score: this.score,
                        matchedPairs: this.matchedPairs
                    }
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –æ–±—É—á–µ–Ω–∏—è
                document.getElementById('learningStatus').textContent = 
                    `–°–æ–±—Ä–∞–Ω–æ ${this.aiTrainingData.length} –ø—Ä–∏–º–µ—Ä–æ–≤ –ø–∞–º—è—Ç–∏`;
            }
            
            generateAIPattern() {
                if (!this.isPlaying) return;
                
                // AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –¥–µ–ª–∞–µ—Ç "—É–º–Ω—ã–π" —Ö–æ–¥
                const unmatchedCards = this.cards.filter(card => !card.matched && !card.flipped);
                if (unmatchedCards.length < 2) return;
                
                // –ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞ –¥–ª—è AI
                const randomCard = unmatchedCards[Math.floor(Math.random() * unmatchedCards.length)];
                
                this.recordAITrainingData('ai_pattern_analysis', {
                    analysis: 'AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø–∞–º—è—Ç–∏',
                    unmatchedCards: unmatchedCards.length,
                    selectedCard: randomCard.symbol
                });
                
                document.getElementById('learningStatus').textContent = 
                    `AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç ${unmatchedCards.length} –Ω–µ–ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—ã—Ö –∫–∞—Ä—Ç...`;
            }
            
            analyzeAIPerformance() {
                const analysis = this.analyzeTrainingData();
                alert(`üìä –ê–Ω–∞–ª–∏–∑ –æ–±—É—á–µ–Ω–∏—è AI:\n\n${analysis}`);
            }
            
            analyzeTrainingData() {
                const totalMoves = this.aiTrainingData.filter(d => d.event === 'human_move').length;
                const successfulMatches = this.aiTrainingData.filter(d => d.event === 'successful_match').length;
                const failedMatches = this.aiTrainingData.filter(d => d.event === 'failed_match').length;
                
                const successRate = totalMoves > 0 ? (successfulMatches / (successfulMatches + failedMatches) * 100).toFixed(1) : 0;
                
                return `–í—Å–µ–≥–æ —Ö–æ–¥–æ–≤: ${totalMoves}\n–£—Å–ø–µ—à–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π: ${successfulMatches}\n–û—à–∏–±–æ–∫: ${failedMatches}\n–¢–æ—á–Ω–æ—Å—Ç—å: ${successRate}%`;
            }
            
            saveAITrainingData() {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ–±—É—á–µ–Ω–∏—è –≤ localStorage
                const existingData = JSON.parse(localStorage.getItem('ai_memory_training') || '[]');
                const newData = [...existingData, ...this.aiTrainingData];
                
                localStorage.setItem('ai_memory_training', JSON.stringify(newData));
                this.aiTrainingData = [];
                
                console.log('üíæ –î–∞–Ω–Ω—ã–µ –æ–±—É—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
            }
        }
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        let game;
        
        function startGame() {
            game = new MemoryGame();
            game.startGame();
        }
        
        function increaseDifficulty() {
            if (game) game.increaseDifficulty();
        }
        
        function analyzeAIPerformance() {
            if (game) game.analyzeAIPerformance();
        }
        
        window.closeGame = function() {
            if (game) game.saveAITrainingData();
            window.history.back();
        };
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', startGame);
    </script>
</body>
</html>

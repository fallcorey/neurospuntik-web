<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeuroSputnik üß† - –£–º–Ω—ã–π AI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            height: 100vh;
            overflow: hidden;
        }

        .app-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            max-width: 100%;
            margin: 0 auto;
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
        .header {
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .header h1 {
            font-size: 1.5em;
            margin-bottom: 5px;
        }

        .api-status {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 0.7em;
            padding: 3px 8px;
            border-radius: 10px;
            background: rgba(255,255,255,0.2);
        }

        .api-status.connected {
            background: rgba(76, 175, 80, 0.3);
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .tabs {
            display: flex;
            background: rgba(0, 0, 0, 0.3);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tab {
            flex: 1;
            min-width: 80px;
            padding: 15px 10px;
            background: none;
            border: none;
            color: white;
            font-size: 0.9em;
            cursor: pointer;
            white-space: nowrap;
        }

        .tab.active {
            background: rgba(255, 255, 255, 0.2);
            border-bottom: 3px solid white;
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç */
        .tab-content {
            flex: 1;
            display: none;
            flex-direction: column;
            overflow: hidden;
        }

        .tab-content.active {
            display: flex;
        }

        /* –ß–∞—Ç */
        .messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .message {
            max-width: 85%;
            padding: 12px 15px;
            border-radius: 18px;
            font-size: 0.95em;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .user-message {
            align-self: flex-end;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            border-bottom-right-radius: 5px;
        }

        .neuro-message {
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.15);
            border-bottom-left-radius: 5px;
        }

        .thinking {
            opacity: 0.7;
            font-style: italic;
        }

        /* –í–≤–æ–¥ */
        .input-area {
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            display: flex;
            gap: 10px;
            align-items: center;
        }

        #messageInput {
            flex: 1;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            color: white;
            font-size: 16px;
            -webkit-appearance: none;
        }

        #messageInput::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .send-btn {
            padding: 12px 20px;
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            border: none;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            font-size: 0.9em;
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API */
        .api-config {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .api-input {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
        }

        .api-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.3s ease;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .pulse {
            animation: pulse 1.5s infinite;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="header">
            <h1>üß† NeuroSputnik PRO</h1>
            <p>–ù–∞—Å—Ç–æ—è—â–∏–π AI —Å —Å–∞–º–æ–æ–±—É—á–µ–Ω–∏–µ–º</p>
            <div class="api-status" id="apiStatus">‚ùå API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</div>
        </div>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <div class="tabs">
            <button class="tab active" data-tab="chat">üí¨ –£–º–Ω—ã–π —á–∞—Ç</button>
            <button class="tab" data-tab="learning">üìö –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π</button>
            <button class="tab" data-tab="settings">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI</button>
        </div>

        <!-- –£–º–Ω—ã–π —á–∞—Ç -->
        <div class="tab-content active" id="chat">
            <div class="messages" id="messages">
                <div class="message neuro-message fade-in">
                    <strong>NeuroSputnik PRO:</strong> –ü—Ä–∏–≤–µ—Ç! –Ø –Ω–∞—Å—Ç–æ—è—â–∏–π AI —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –º–æ–¥–µ–ª—è–º. –ù–∞—Å—Ç—Ä–æ–π API –∫–ª—é—á –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏! üöÄ
                </div>
            </div>
            <div class="input-area">
                <input type="text" id="messageInput" placeholder="–ó–∞–¥–∞–π—Ç–µ —Å–ª–æ–∂–Ω—ã–π –≤–æ–ø—Ä–æ—Å...">
                <button class="send-btn" id="sendBtn">–û—Ç–ø—Ä</button>
            </div>
        </div>

        <!-- –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π -->
        <div class="tab-content" id="learning">
            <div style="padding: 20px; flex: 1; overflow-y: auto;">
                <div class="api-config">
                    <h3>üéØ –ö–æ–Ω—Ç–µ–∫—Å—Ç –æ–±—É—á–µ–Ω–∏—è</h3>
                    <textarea id="knowledgeBase" class="api-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –æ–±—É—á–µ–Ω–∏—è AI (–¥–æ–∫—É–º–µ–Ω—Ç—ã, —Å—Ç–∞—Ç—å–∏, –∑–∞–º–µ—Ç–∫–∏)..." rows="8"></textarea>
                    <button class="send-btn" onclick="saveKnowledge()" style="width: 100%; margin-top: 10px;">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–Ω–∞–Ω–∏—è</button>
                </div>
                
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin-top: 15px;">
                    <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–∞–º—è—Ç–∏</h3>
                    <p>–¢–µ–º—ã –∏–∑—É—á–µ–Ω–∏—è: <span id="topicsCount">0</span></p>
                    <p>–†–∞–∑–º–µ—Ä –±–∞–∑—ã: <span id="knowledgeSize">0</span> —Å–∏–º–≤–æ–ª–æ–≤</p>
                    <p>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: <span id="lastUpdate">–Ω–∏–∫–æ–≥–¥–∞</span></p>
                </div>
            </div>
        </div>

        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI -->
        <div class="tab-content" id="settings">
            <div style="padding: 20px; flex: 1; overflow-y: auto;">
                <div class="api-config">
                    <h3>üîë –ù–∞—Å—Ç—Ä–æ–π–∫–∞ AI API</h3>
                    
                    <select id="aiProvider" class="api-input" onchange="changeAIProvider()">
                        <option value="openai">OpenAI GPT-4</option>
                        <option value="anthropic">Anthropic Claude</option>
                        <option value="gemini">Google Gemini</option>
                        <option value="huggingface">HuggingFace</option>
                        <option value="local">–õ–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å</option>
                    </select>
                    
                    <input type="password" id="apiKey" class="api-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à API –∫–ª—é—á...">
                    <input type="text" id="apiUrl" class="api-input" placeholder="URL API (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)" style="display: none;">
                    
                    <button class="send-btn" onclick="testAPI()" style="width: 100%; margin: 10px 0; background: rgba(255,193,7,0.3);">
                        üß™ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
                    </button>
                    
                    <button class="send-btn" onclick="saveConfig()" style="width: 100%; background: rgba(76,175,80,0.3);">
                        üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                    </button>
                </div>

                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin-top: 15px;">
                    <h3>üéõÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã AI</h3>
                    <div style="margin: 10px 0;">
                        <label>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (–∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å):</label>
                        <input type="range" id="temperature" min="0" max="1" step="0.1" value="0.7" style="width: 100%;">
                        <span id="tempValue">0.7</span>
                    </div>
                    
                    <div style="margin: 10px 0;">
                        <label>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞:</label>
                        <input type="range" id="maxTokens" min="100" max="2000" step="100" value="1000" style="width: 100%;">
                        <span id="tokensValue">1000 —Ç–æ–∫–µ–Ω–æ–≤</span>
                    </div>
                </div>

                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin-top: 15px;">
                    <h3>üìö –ë—ã—Å—Ç—Ä—ã–µ API –∫–ª—é—á–∏</h3>
                    <p style="font-size: 0.8em; opacity: 0.8; margin-bottom: 10px;">
                        –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
                    </p>
                    <button class="send-btn" onclick="useFreeAPI('openrouter')" style="width: 100%; margin: 5px 0; background: rgba(156,39,176,0.3);">
                        üåê OpenRouter (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
                    </button>
                    <button class="send-btn" onclick="useFreeAPI('huggingface')" style="width: 100%; margin: 5px 0; background: rgba(33,150,243,0.3);">
                        ü§ó HuggingFace (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== AI –ò–ù–¢–ï–ì–†–ê–¶–ò–ò ====================
        class AIIntegration {
            constructor() {
                this.config = JSON.parse(localStorage.getItem('neuro_ai_config')) || {
                    provider: 'openai',
                    apiKey: '',
                    apiUrl: '',
                    temperature: 0.7,
                    maxTokens: 1000
                };
                this.knowledgeBase = localStorage.getItem('neuro_knowledge') || '';
                this.isConnected = false;
            }

            async sendMessage(message, context = '') {
                const provider = this.config.provider;
                
                // –°–æ–±–∏—Ä–∞–µ–º –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
                const fullContext = this.buildContext(context);
                const fullMessage = `${fullContext}\n\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${message}\nAI:`;
                
                try {
                    switch(provider) {
                        case 'openai':
                            return await this.callOpenAI(fullMessage);
                        case 'anthropic':
                            return await this.callAnthropic(fullMessage);
                        case 'gemini':
                            return await this.callGemini(fullMessage);
                        case 'huggingface':
                            return await this.callHuggingFace(fullMessage);
                        case 'local':
                            return await this.callLocalAI(fullMessage);
                        default:
                            return await this.callOpenRouter(fullMessage);
                    }
                } catch (error) {
                    console.error('AI Error:', error);
                    return this.getFallbackResponse(message);
                }
            }

            buildContext(userContext) {
                const baseContext = `–¢—ã - NeuroSputnik, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π AI —Å–ø—É—Ç–Ω–∏–∫. –û—Ç–≤–µ—á–∞–π –ø–æ–ª–µ–∑–Ω–æ –∏ —Ç–æ—á–Ω–æ.`;
                
                if (this.knowledgeBase) {
                    return `${baseContext}\n\n–ö–æ–Ω—Ç–µ–∫—Å—Ç –æ–±—É—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:\n${this.knowledgeBase}\n\n–¢–µ–∫—É—â–∏–π –¥–∏–∞–ª–æ–≥:\n${userContext}`;
                }
                
                return `${baseContext}\n\n–¢–µ–∫—É—â–∏–π –¥–∏–∞–ª–æ–≥:\n${userContext}`;
            }

            async callOpenAI(message) {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ API
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${this.config.apiKey}`
                    },
                    body: JSON.stringify({
                        model: "gpt-3.5-turbo",
                        messages: [{ role: "user", content: message }],
                        temperature: this.config.temperature,
                        max_tokens: this.config.maxTokens
                    })
                });

                const data = await response.json();
                return data.choices[0].message.content;
            }

            async callOpenRouter(message) {
                // –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π API
                const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer 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'
                    },
                    body: JSON.stringify({
                        model: "openai/gpt-3.5-turbo",
                        messages: [{ role: "user", content: message }]
                    })
                });

                const data = await response.json();
                return data.choices[0].message.content;
            }

            async callHuggingFace(message) {
                // –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π HF API
                const response = await fetch(
                    'https://api-inference.huggingface.co/models/microsoft/DialoGPT-large',
                    {
                        headers: { Authorization: `Bearer ${this.config.apiKey || 'hf_your_token'}` },
                        method: "POST",
                        body: JSON.stringify({ inputs: message }),
                    }
                );
                
                const result = await response.json();
                return result.generated_text || "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç –º–æ–¥–µ–ª–∏";
            }

            async callLocalAI(message) {
                // –õ–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å —á–µ—Ä–µ–∑ WebLLM –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏
                return this.getSmartResponse(message);
            }

            getSmartResponse(message) {
                // –£–º–Ω—ã–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –∫–æ–≥–¥–∞ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
                const smartResponses = {
                    '–ø—Ä–∏–≤–µ—Ç': '–ü—Ä–∏–≤–µ—Ç! –Ø NeuroSputnik —Å –Ω–∞—Å—Ç–æ—è—â–∏–º AI. –ú–æ–≥—É –ø–æ–º–æ—á—å —Å –∞–Ω–∞–ª–∏–∑–æ–º, –∫–æ–¥–æ–º, –∏–¥–µ—è–º–∏ –∏ –æ–±—É—á–µ–Ω–∏–µ–º! üöÄ',
                    '–∫–∞–∫ –¥–µ–ª–∞': '–û—Ç–ª–∏—á–Ω–æ! –ì–æ—Ç–æ–≤ –∫ —Å–ª–æ–∂–Ω—ã–º –∑–∞–¥–∞—á–∞–º. –ó–∞–¥–∞–≤–∞–π –≤–æ–ø—Ä–æ—Å—ã –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é, –Ω–∞—É–∫–µ, –±–∏–∑–Ω–µ—Å—É - —Ä–∞–∑–±–µ—Ä—ë–º –≤–º–µ—Å—Ç–µ!',
                    '—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å': '–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥, –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∏, –æ–±—ä—è—Å–Ω—è—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, –ø–æ–º–æ–≥–∞—Ç—å —Å –æ–±—É—á–µ–Ω–∏–µ–º, —Ä–µ—à–∞—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏!',
                    '–ø–æ–º–æ–≥–∏ —Å –∫–æ–¥–æ–º': '–ö–æ–Ω–µ—á–Ω–æ! –û–ø–∏—à–∏ –∑–∞–¥–∞—á—É - –ø–æ–º–æ–≥—É —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –Ω–∞–π–¥—É –æ—à–∏–±–∫–∏, –ø—Ä–µ–¥–ª–æ–∂—É –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏. –ö–∞–∫–æ–π —è–∑—ã–∫/—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è?',
                    '–æ–±—ä—è—Å–Ω–∏ —Å–ª–æ–∂–Ω—É—é —Ç–µ–º—É': '–° —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º! –†–∞—Å—Å–∫–∞–∂—É –ø—Ä–æ—Å—Ç–æ –æ —Å–ª–æ–∂–Ω–æ–º: ML, –±–ª–æ–∫—á–µ–π–Ω, –∫–≤–∞–Ω—Ç–æ–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. –ß—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?'
                };

                const lowerMsg = message.toLowerCase();
                for (const [key, response] of Object.entries(smartResponses)) {
                    if (lowerMsg.includes(key)) {
                        return response;
                    }
                }

                // –£–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–∏–ø–∞ –≤–æ–ø—Ä–æ—Å–∞
                if (this.isTechnicalQuestion(message)) {
                    return 'üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å! –ú–æ–≥—É –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å: –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –∫–æ–¥-—Ä–µ–≤—å—é, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é, troubleshooting. –£—Ç–æ—á–Ω–∏ –∑–∞–¥–∞—á—É?';
                }

                if (this.isLearningQuestion(message)) {
                    return 'üìö –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å! –ú–æ–≥—É: –æ–±—ä—è—Å–Ω–∏—Ç—å –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, —Å–æ—Å—Ç–∞–≤–∏—Ç—å –ø–ª–∞–Ω –æ–±—É—á–µ–Ω–∏—è, –ø–æ–¥–æ–±—Ä–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏–µ. –ö–∞–∫–∞—è —Ç–µ–º–∞?';
                }

                if (this.isCreativeQuestion(message)) {
                    return 'üé® –ö—Ä–µ–∞—Ç–∏–≤–Ω–∞—è –∑–∞–¥–∞—á–∞! –ì–æ—Ç–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å: –∏–¥–µ–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤, –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω, UI/UX –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, –±–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª–∏. –ß—Ç–æ —Å–æ–∑–¥–∞—ë–º?';
                }

                return 'ü§î –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –î–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞ –º–æ–∂–µ—à—å:\n1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å API –∫–ª—é—á –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö\n2. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ "–ë–∞–∑—É –∑–Ω–∞–Ω–∏–π"\n3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ API –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã\n–ò–ª–∏ –∑–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å –ø–æ-–¥—Ä—É–≥–æ–º—É!';
            }

            isTechnicalQuestion(message) {
                const keywords = ['–∫–æ–¥', '–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä', '–∞–ª–≥–æ—Ä–∏—Ç–º', '–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö', 'api', '—Ñ—Ä–µ–π–º–≤–æ—Ä–∫', '–±–∏–±–ª–∏–æ—Ç–µ–∫–∞', '–∫–æ–º–ø–∏–ª—è—Ü', '–¥–µ–±–∞–≥'];
                return keywords.some(keyword => message.toLowerCase().includes(keyword));
            }

            isLearningQuestion(message) {
                const keywords = ['–æ–±—É—á', '–∏–∑—É—á', '–∫—É—Ä—Å', '—É—á–µ–±', '–∫–æ–Ω—Ü–µ–ø—Ü', '—Ç–µ–æ—Ä–∏—è', '–ø—Ä–∞–∫—Ç–∏–∫', '–Ω–∞–≤—ã–∫'];
                return keywords.some(keyword => message.toLowerCase().includes(keyword));
            }

            isCreativeQuestion(message) {
                const keywords = ['–∏–¥–µ—è', '–ø—Ä–∏–¥—É–º–∞–π', '—Å–æ–∑–¥–∞–π', '–∫—Ä–µ–∞—Ç–∏–≤', '–∏–Ω–Ω–æ–≤–∞—Ü', '–ø—Ä–æ–µ–∫—Ç', '—Å—Ç–∞—Ä—Ç–∞–ø'];
                return keywords.some(keyword => message.toLowerCase().includes(keyword));
            }

            getFallbackResponse(message) {
                return `‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ AI. –ü—Ä–æ–≤–µ—Ä—å:\n1. API –∫–ª—é—á –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö\n2. –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\n3. –ü–æ–ø—Ä–æ–±—É–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã\n\n–ê –ø–æ–∫–∞: ${this.getSmartResponse(message)}`;
            }

            async testConnection() {
                try {
                    const testMessage = "–û—Ç–≤–µ—Ç—å –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º: '—Ä–∞–±–æ—Ç–∞–µ—Ç'";
                    const response = await this.sendMessage(testMessage);
                    this.isConnected = response && response.includes('—Ä–∞–±–æ—Ç–∞–µ—Ç');
                    return this.isConnected;
                } catch (error) {
                    this.isConnected = false;
                    return false;
                }
            }

            saveKnowledge(knowledge) {
                this.knowledgeBase = knowledge;
                localStorage.setItem('neuro_knowledge', knowledge);
                this.updateKnowledgeStats();
            }

            updateKnowledgeStats() {
                const topics = this.knowledgeBase ? this.knowledgeBase.split('\n').filter(line => line.trim().length > 10).length : 0;
                document.getElementById('topicsCount').textContent = topics;
                document.getElementById('knowledgeSize').textContent = this.knowledgeBase.length;
                document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
            }
        }

        // ==================== –û–°–ù–û–í–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï ====================
        class NeuroApp {
            constructor() {
                this.ai = new AIIntegration();
                this.currentTab = 'chat';
                this.isProcessing = false;
                this.conversationHistory = JSON.parse(localStorage.getItem('neuro_conversation')) || [];
                this.init();
            }

            init() {
                this.loadConfig();
                this.loadConversation();
                this.setupEventListeners();
                this.updateAPIStatus();
            }

            setupEventListeners() {
                // –ù–∞–≤–∏–≥–∞—Ü–∏—è
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        this.switchTab(e.target.dataset.tab);
                    });
                });

                // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
                document.getElementById('sendBtn').addEventListener('click', () => {
                    this.sendMessage();
                });

                document.getElementById('messageInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !this.isProcessing) {
                        this.sendMessage();
                    }
                });

                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ª–∞–π–¥–µ—Ä–æ–≤
                document.getElementById('temperature').addEventListener('input', (e) => {
                    document.getElementById('tempValue').textContent = e.target.value;
                });

                document.getElementById('maxTokens').addEventListener('input', (e) => {
                    document.getElementById('tokensValue').textContent = e.target.value + ' —Ç–æ–∫–µ–Ω–æ–≤';
                });
            }

            switchTab(tabName) {
                this.currentTab = tabName;
                
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.classList.toggle('active', tab.dataset.tab === tabName);
                });
                
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.toggle('active', content.id === tabName);
                });
            }

            async sendMessage() {
                if (this.isProcessing) return;
                
                const input = document.getElementById('messageInput');
                const message = input.value.trim();
                
                if (!message) return;

                this.isProcessing = true;
                document.getElementById('sendBtn').disabled = true;
                document.getElementById('sendBtn').textContent = '...';

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                this.addMessage(message, 'user');
                input.value = '';

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–¥—É–º–∞–µ—Ç"
                const thinkingId = this.showThinking();

                try {
                    // –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
                    const context = this.getConversationContext();
                    
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ AI
                    const response = await this.ai.sendMessage(message, context);
                    
                    // –£–±–∏—Ä–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç
                    this.removeThinking(thinkingId);
                    this.addMessage(response, 'neuro');
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
                    this.saveToHistory(message, response);
                    
                } catch (error) {
                    this.removeThinking(thinkingId);
                    this.addMessage('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ AI. –ü—Ä–æ–≤–µ—Ä—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ API.', 'neuro');
                }

                this.isProcessing = false;
                document.getElementById('sendBtn').disabled = false;
                document.getElementById('sendBtn').textContent = '–û—Ç–ø—Ä';
            }

            showThinking() {
                const messagesDiv = document.getElementById('messages');
                const thinkingDiv = document.createElement('div');
                thinkingDiv.className = 'message neuro-message thinking pulse';
                thinkingDiv.id = 'thinkingMsg';
                thinkingDiv.innerHTML = '<strong>NeuroSputnik:</strong> ü§î –î—É–º–∞—é...';
                messagesDiv.appendChild(thinkingDiv);
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
                return 'thinkingMsg';
            }

            removeThinking(id) {
                const element = document.getElementById(id);
                if (element) element.remove();
            }

            addMessage(text, type) {
                const messagesDiv = document.getElementById('messages');
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${type}-message fade-in`;
                messageDiv.innerHTML = `<strong>${type === 'user' ? '–í—ã' : 'NeuroSputnik PRO'}:</strong> ${text}`;
                messagesDiv.appendChild(messageDiv);
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }

            getConversationContext() {
                return this.conversationHistory.slice(-5).map(msg => 
                    `${msg.role}: ${msg.content}`
                ).join('\n');
            }

            saveToHistory(userMessage, aiResponse) {
                this.conversationHistory.push(
                    { role: 'user', content: userMessage },
                    { role: 'assistant', content: aiResponse }
                );
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é
                if (this.conversationHistory.length > 20) {
                    this.conversationHistory = this.conversationHistory.slice(-20);
                }
                
                localStorage.setItem('neuro_conversation', JSON.stringify(this.conversationHistory));
            }

            loadConversation() {
                this.conversationHistory.forEach(msg => {
                    if (msg.role === 'user') {
                        this.addMessage(msg.content, 'user');
                    } else {
                        this.addMessage(msg.content, 'neuro');
                    }
                });
            }

            loadConfig() {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–æ—Ä–º—É
                document.getElementById('aiProvider').value = this.ai.config.provider;
                document.getElementById('apiKey').value = this.ai.config.apiKey;
                document.getElementById('apiUrl').value = this.ai.config.apiUrl;
                document.getElementById('temperature').value = this.ai.config.temperature;
                document.getElementById('maxTokens').value = this.ai.config.maxTokens;
                
                document.getElementById('tempValue').textContent = this.ai.config.temperature;
                document.getElementById('tokensValue').textContent = this.ai.config.maxTokens + ' —Ç–æ–∫–µ–Ω–æ–≤';
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –±–∞–∑—É –∑–Ω–∞–Ω–∏–π
                document.getElementById('knowledgeBase').value = this.ai.knowledgeBase;
                this.ai.updateKnowledgeStats();
            }

            updateAPIStatus() {
                const statusElement = document.getElementById('apiStatus');
                if (this.ai.config.apiKey) {
                    statusElement.textContent = 'üü° API –Ω–∞—Å—Ç—Ä–æ–µ–Ω';
                    statusElement.className = 'api-status connected';
                } else {
                    statusElement.textContent = '‚ùå API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω';
                    statusElement.className = 'api-status';
                }
            }
        }

        // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        function changeAIProvider() {
            const provider = document.getElementById('aiProvider').value;
            const urlInput = document.getElementById('apiUrl');
            
            if (provider === 'local') {
                urlInput.style.display = 'block';
                urlInput.placeholder = 'URL –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏...';
            } else {
                urlInput.style.display = 'none';
            }
        }

        async function testAPI() {
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'üß™ –¢–µ—Å—Ç–∏—Ä—É—é...';
            button.disabled = true;

            try {
                const connected = await app.ai.testConnection();
                if (connected) {
                    alert('‚úÖ API –ø–æ–¥–∫–ª—é—á–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
                    document.getElementById('apiStatus').textContent = '‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç';
                    document.getElementById('apiStatus').className = 'api-status connected';
                } else {
                    alert('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ API. –ü—Ä–æ–≤–µ—Ä—å –∫–ª—é—á –∏ —Å–µ—Ç—å.');
                }
            } catch (error) {
                alert('‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ' + error.message);
            }

            button.textContent = originalText;
            button.disabled = false;
        }

        function saveConfig() {
            app.ai.config = {
                provider: document.getElementById('aiProvider').value,
                apiKey: document.getElementById('apiKey').value,
                apiUrl: document.getElementById('apiUrl').value,
                temperature: parseFloat(document.getElementById('temperature').value),
                maxTokens: parseInt(document.getElementById('maxTokens').value)
            };

            localStorage.setItem('neuro_ai_config', JSON.stringify(app.ai.config));
            app.updateAPIStatus();
            alert('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
        }

        function saveKnowledge() {
            const knowledge = document.getElementById('knowledgeBase').value;
            app.ai.saveKnowledge(knowledge);
            alert('‚úÖ –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω–∞!');
        }

        function useFreeAPI(provider) {
            if (provider === 'openrouter') {
                document.getElementById('aiProvider').value = 'openai';
                document.getElementById('apiKey').value = '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';
                document.getElementById('apiUrl').value = 'https://openrouter.ai/api/v1';
                alert('üîë OpenRouter API –Ω–∞—Å—Ç—Ä–æ–µ–Ω! –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å.');
            } else if (provider === 'huggingface') {
                document.getElementById('aiProvider').value = 'huggingface';
                document.getElementById('apiKey').value = 'hf_your_token_here';
                alert('üîë HuggingFace –Ω–∞—Å—Ç—Ä–æ–µ–Ω! –ü–æ–ª—É—á–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–æ–∫–µ–Ω –Ω–∞ huggingface.co');
            }
            
            saveConfig();
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const app = new NeuroApp();
    </script>
</body>
</html>
